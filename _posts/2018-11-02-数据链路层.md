---
title: 数据链路层
date: 2018-11-02 23:29:53
categories:
- 2018年11月
- 学习笔记
tags:
- 学习
- 通信方式
---

#信道类型#

1. 点对点信道
2. 广播信道

#点对点信道的数据链路层#

##数据链路和帧##

**链路（link）**：一个结点到相邻结点的一段物理线路（有线或者无线），中间没有任何其他的交换结点。也称**物理链路**。

**数据链路（data link）**：实现必要通信协议的硬件和软件（网络适配器）加到链路上。也称**逻辑链路**。

规程和协议是同义语。因为早期的数据通信协议曾叫**通信规程**。

**帧**：点对点信道的数据链路层的协议数据单元。

数据链路层把网络层交下来的数据构成帧发送到链路上，以及把帧中的数据取出并上交给网络层。

点对点信道的数据链路层再进行通信时的主要步骤：

1. 结点A的数据链路层把网络层交下来的IP数据报添加首部和尾部封装成帧。
2. 结点A把封装好的帧发送给结点B的数据链路层。
3. 若结点B的数据链路层收到的帧无差错，则从收到的帧提取IP数据报交给上面的网络层；否则丢弃这个帧。
 
##三个基本问题##

**封装成帧、透明传输、差错检测**

### 封装成帧 ###

在一段数据的前后分别添加首部和尾部，构成一个帧。接收端在收到物理层上交的比特流后，就能根据首部和尾部的标记（使用专门指明的**控制字符**，可以类比C程序中函数的花括号），从收到的比特流中识别帧的开始和结束。帧长等于帧的数据部分长度加上帧首部和帧尾部的长度。

帧的首部和尾部的重要作用：进行帧定界（确定帧的界限）。每一种链路层协议都有规定所能发送的帧的数据部分长度上限——最大传送单元MTU。只有收到明确的帧定界符（SOH和EOT）才能判断是一个完整的帧。

### 透明传输 ###

由于每个帧有相应的定界标识，因此所传输的数据中任何8比特的组合不允许和用作帧定界的控制字符的比特编码一样。否则将造成帧定界混乱的情况。具体的情况可以类比C程序中错误使用{}（花括号）的情况。

当传送的帧是用文本文件组成的帧时（都是从键盘上输入的），帧的数据部分不会出现帧定界控制字符，这样情况下的数据都能通过帧发送过去，该传输称为**透明传输**。

**透明**：某一个实际存在的事物看起来却好像不存在一样。

这样看来好像问题也不大，不要出现控制字符就好了，而我们在输入时也不会出现控制字符。而且实际上在输入中出现的字符"EOT"并非控制字符而仅仅是二进制数据00000100。

若是为了解决透明传输的问题，就要在控制字符前插入一个转义字符"ESC"。在接收端的数据链路层把数据送往网络层前删除这些插入的转义字符。这种方法叫做**字节填充**或者**字符填充**。

### 差错检测 ###

**比特差错**：0变成1，0变成1。

**误码率BER**：传输错误的比特占所传输比特总数的比率。	 

目前在数据链路层广泛使用**循环冗余检测CRC**的检错技术。

上诉是比较基本的比特差错，而另一类出现的传输差错更复杂些，没有比特差错，却出现了**帧丢失**、**帧重复**或者**帧失序**的情况。在CRC检错的基础上，增加了**帧编号**、**确认**和**重传机制**。现在采用差别对待的方式，对于通信质量良好的有限传输链路和通信质量较差的无线传输链路进行差别对待。

## 点对点协议PPP ##

### PPP协议的特点 ###

#### PPP协议应满足的需求 ####

1. 简单。只进行CRC检验，针对第一种传输错误。
2. 封装成帧。必须规定特殊的字符作为帧定界符。
3. 透明性。
4. 多种网络层协议。同一条物理链路上支持多种网络层协议。
5. 多种类型链路。
6. 差错检测。
7. 检测连接装置。
8. 最大传送单元。设置MTU的标准默认值。MTU是数据链路层的帧可以载荷的数据部分最大长度，而非帧的总长度。
9. 网络层地址协商。
10. 数据压缩协商。

PPP协议不支持多点线路，只支持点对点的链路通信，只支持全双工链路。

#### PPP协议的组成 ####

1. 将IP数据报封装到串行链路的方法。
2. 用来建立、配置和测试数据链路连接的**链路控制协议LCP**
3. **网络控制协议NCP**

### PPP协议的帧格式 ###

#### 各字段的意义 ####

见图

### 字节填充 ###

如前

#### 零比特填充 ####

使用同步传输时用，采用**零比特传输**实现透明传输。

发现5个连续的 1 则立即填入一个 0 。接收端再还原。

### PPP协议的工作状态 ###

见图

## 使用广播信道的数据链路层 ##

### 局域网的数据链路层 ###

网络为一个单位所拥有，且地理范围和站点数目均有限。

局域网优点：

1. 具有广播功能。
2. 便于系统的扩展和逐渐演变，各设备的位置可灵活调整和改变。
3. 提高了系统的可靠性、可用性和生存性。

共享信道方法：

1. 静态划分信道。
2. 动态媒体接入控制（多点接入）。
	1. 随机接入。
	2. 受控接入。

### CSMA/CD协议 ###

载波监听多点接入/碰撞检测

要点：

-  “多点接入”：总线型网络。
-  “载波监听”：监听信道，检测总线上有没有其他计算机也在发送。
-  “碰撞检测”：检测是否同时在发送信号。虽然在发送信号前已经先“载波监听”过了，但由于电磁波的速率有限，有相应延迟，所以还是容易产生碰撞。

在使用CSMA/CD协议时，一个站不可能同时进行发送和接收。所以使用 该协议的以太网不可能进行全双工通信而只能进行**双向交替通信（半双工通信）**。

**发送的不确定性**：每一个站在自己发送数据之后的一小段时间内，存在着遭遇碰撞的可能性。碰撞之后将全部停止发送。

**过程**：

1. 准备发送：封装成帧。
2. 检测信道：等待信道转为空闲。
3. 边发送边监听：发送过程中要是发送成功（过了争用期）回到步骤1；若是发生碰撞，立即停止发送数据。

因此每发送完一帧，暂时保存下，防止发生碰撞。