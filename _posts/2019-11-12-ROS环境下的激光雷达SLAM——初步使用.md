---
title: ROSç¯å¢ƒä¸‹çš„æ¿€å…‰é›·è¾¾SLAMâ€”â€”åˆæ­¥ä½¿ç”¨
date: 2019-11-12 23:29:53
categories:
- 2019å¹´11æœˆ
- å­¦ä¹ ç¬”è®°
tags:
- å­¦ä¹ 
- ROS
- æ¿€å…‰é›·è¾¾
---

æœ¬æ–‡ä½¿ç”¨çš„æ¿€å…‰é›·è¾¾ä¸ºhokuyo-UTM-30LX USBå£ã€‚ç®€å•ä»‹ç»äº†é›·è¾¾ä»¥åŠROSç¯å¢ƒä¸‹çš„ç®€å•é…ç½®ä¸ä½¿ç”¨ã€‚

<!--more-->

æœ¬æ–‡åŸºäºç½‘ä¸Šçš„èµ„æ–™ä»¥åŠè‡ªå·±çš„å®è·µå®Œæˆã€‚è¯¦ç»†çš„ç½‘å€å¦‚ä¸‹ï¼š

 https://www.ncnynl.com/archives/201805/2419.html 

 https://blog.csdn.net/sinat_36330809/article/details/82781487 

 https://blog.csdn.net/Leo_Xj/article/details/88661664 

[Linux/Ubuntu\] vi/vim ä½¿ç”¨æ–¹æ³•è®²è§£ï¼š

 https://www.cnblogs.com/begintime/p/6565593.html 

# æ¿€å…‰é›·è¾¾ï¼ˆhokuyoï¼‰

- HOKUYOå…¬å¸ç”Ÿäº§å¤šæ¬¾æ¿€å…‰æ‰«ææµ‹è·äº§å“ï¼Œå¦‚UTM-30LXæ‹¥æœ‰30m, 270Â°æµ‹é‡èŒƒå›´ï¼ŒIP64é˜²æŠ¤ç­‰çº§å¯ç”¨äºæˆ·å¤–å®‰è£…ï¼ŒDC12Vè¾“å…¥ï¼Œ25msæ‰«ææ—¶é—´

- HOKUYOå‹å·ï¼š UTM-30LX, URG-04LX, UBG-04LX-F01, URG-04LX-UG01

- ç”¨é€”ï¼šæœºå™¨äººç¯å¢ƒè¯†åˆ« ã€ å»ºç­‘ç‰©å…¥ä¾µä¿æŠ¤ï¼ˆå®‰é˜²ï¼‰ã€ è‡ªåŠ¨é—¨/è¡Œä¸ºæ–¹å¼è¯†åˆ«ã€ è‡ªåŠ¨å¯¼èˆªè½¦è¾†ï¼ˆAGVï¼‰éšœç¢æ£€æµ‹ã€ æ— äººé£è¡Œå™¨é¿éšœå’Œè‡ªä¸»å¯¼èˆªã€‚

- å›¾ç¤ºï¼š

 ![è¯·è¾“å…¥å›¾ç‰‡æè¿°](http://images.ncnynl.com/ros/2016/Hokuyo.jpg) 

# ROSç¯å¢ƒä¸‹çš„é…ç½®ä½¿ç”¨

## debåŒ…å®‰è£…

- åˆ©ç”¨debåŒ…å®‰è£…ï¼ŒDISTroä¸ºå¯¹ROSç‰ˆæœ¬ 

```cmd
$ sudo apt-get install ros-%DISTro%-urg-node
```

æ³¨ï¼šåœ¨å°†DISTroæ›¿æ¢æˆç›¸åº”ç‰ˆæœ¬å·ä¹‹åï¼Œè®°å¾—å°†%%å»é™¤ã€‚

æ¯”å¦‚æˆ‘ç”¨çš„æ˜¯rosçš„melodicç‰ˆæœ¬äºæ˜¯æˆ‘ä¾¿è¾“å…¥

```cmd
$ sudo apt-get install ros-melodic-urg-node
```

å½“ç„¶ï¼Œè¿™è¦æ˜¯å‡ºç°æ— æ³•å®šä¹‰è½¯ä»¶åŒ…ç­‰ä¿¡æ¯ï¼Œå¯èƒ½æ˜¯ç½‘ç»œé—®é¢˜ï¼Œæ›´æ¢Ubuntuæºä¹‹ååº”è¯¥èƒ½è§£å†³ã€‚

## æºç å®‰è£…

- å»ºç«‹å·¥ä½œç©ºé—´ï¼ˆä¹Ÿå¯ä»¥åˆ©ç”¨ç°æœ‰çš„ï¼‰ï¼Œç¼–è¯‘åŒ…

```cmd
$ mkdir -p  ~/turtlebot_ws/src
$ cd   ~/turtlebot_ws/src

## æ¿€å…‰é›·è¾¾Hokuyo nodeé©±åŠ¨
$ git clone https://github.com/ncnynl/urg_node.git


## turtlebotå»ºå›¾ä¾èµ–åŒ…
$ git clone https://github.com/turtlebot/turtlebot_apps 


#ç¼–è¯‘
$ cd  ~/turtlebot_ws
$ catkin_make
```

åœ¨æœ€åä¸€æ­¥ç¼–è¯‘ï¼Œcmakeå¯èƒ½ä¼šæŠ¥é”™ï¼Œæ­¤æ—¶æŠŠæŠ¥é”™çš„æ–‡ä»¶åˆ é™¤

 ![img](https://img-blog.csdn.net/20180920093955897?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3NpbmF0XzM2MzMwODA5/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70) 

 ![img](https://img-blog.csdn.net/2018092009402381?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3NpbmF0XzM2MzMwODA5/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70) 

å°†turtlebot_followeræ–‡ä»¶å¤¹åˆ é™¤ã€‚

è¯¥æ–‡ä»¶å¤¹æ­¤æ—¶æ‰€åœ¨è·¯å¾„ä¸ºturtlebot_ws/src/turtlebot_apps

é‡æ–°catkin_makeæˆåŠŸ

```cmd
$ catkin_make
```

- æ·»åŠ ç¯å¢ƒå˜é‡ï¼Œåœ¨~/.bashrcæœ€åæ·»åŠ ä¸€è¡Œï¼š

```cmd
$ source /home/ubu/turtlebot_ws/devel/setup.bash
```

æ³¨ï¼šä¸Šè¯‰å‘½ä»¤è¡Œçš„ubuä¸ºç”¨æˆ·åï¼Œä¸æ¸…æ¥šçš„å¯ä»¥è‡ªå·±æŸ¥çœ‹æ–‡ä»¶å¤¹è·¯å¾„ã€‚

- åˆ·æ–°é…ç½®

```cmd
$ source ~/.bashrc
#æˆ–è€…
$ rospack profile
```

## é…ç½®

- æ·»åŠ åˆ«å
- å»ºç«‹ hokuyo-utm-30lx.rules 

```cmd
cd ~ 
vim hokuyo-utm-30lx.rules
```

æ­¤å¤„è¦æ˜¯æ²¡æœ‰å®‰è£…vimå¯ä»¥æŒ‰ç…§åé¦ˆä¿¡æ¯å®‰è£…ä¸‹ã€‚vimçš„ä½¿ç”¨å¯æŸ¥çœ‹æ–‡ç« å¼€å¤´çš„ã€Š[Linux/Ubuntu\] vi/vim ä½¿ç”¨æ–¹æ³•è®²è§£ã€‹ï¼Œä¹Ÿå¯ä»¥ä¸ç”¨å‘½ä»¤è¡Œï¼Œç›´æ¥è¿›å…¥æ–‡ä»¶ä¸­åˆ©ç”¨æ–‡æœ¬ç¼–è¾‘å™¨æ–°å»ºã€‚

- hokuyo-utm-30lx.rulesçš„å†…å®¹å¦‚ä¸‹

```cmd
SUBSYSTEMS=="usb", KERNEL=="ttyACM[0-9]*", ACTION=="add", ATTRS{idVendor}=="15d1", ATTRS{idProduct}=="0000", MODE="666",  SYMLINK+="hokuyo", GROUP="dialout"
```

- å¤åˆ¶ hokuyo-utm-30lx.rulesåˆ°/etc/udev/rules.d/ 

```cmd
sudo mv hokuyo-utm-30lx.rules /etc/udev/rules.d/
```

- é‡å¯udev

```cmd
sudo service udev reload 
sudo service udev restart
```

- é‡æ’æ¿€å…‰é›·è¾¾çš„USBå£ï¼ˆåˆ‡è®°æ¿€å…‰é›·è¾¾è¦ä¸Šç”µğŸ˜‚mdzzã€‚ã€‚ã€‚ã€‚ï¼‰
- æŸ¥çœ‹ç«¯å£

```cmd
$ ls -l /dev/hokuyo
#è¿”å›ä»¥ä¸‹æ•°æ®
crw-rw-XX- 1 root dialout 166, 0 2009-10-27 14:18 /dev/hokuyo
```

- åœ¨å…¶ä¸­ä¸€ä¸ªåŒ…ä¸­å¢åŠ launchæ–‡ä»¶

```cmd
roscd turtlebot_navigation/launch
vim hokuyo.launch
```

å†…å®¹å¦‚ä¸‹ï¼š

```cmd
<launch>
  <node name="urg_node" pkg="urg_node" type="urg_node" output="screen">
    <param name="ip_address" value=""/>
    <param name="serial_port" value="/dev/hokuyo"/>
    <param name="serial_baud" value="115200"/>
    <param name="frame_id" value="laser"/>
    <param name="calibrate_time" value="true"/>
    <param name="publish_intensity" value="false"/>
    <param name="publish_multiecho" value="false"/>
    <param name="angle_min" value="-1.5707963"/>
    <param name="angle_max" value="1.5707963"/>
  </node>
</launch>
```

## æµ‹è¯•

- æ–°å¼€ç»ˆç«¯ï¼Œå¯åŠ¨roscore

```cmd
$ roscore
```

-  æ–°å¼€ç»ˆç«¯ï¼Œè¿è¡ŒèŠ‚ç‚¹ 

```cmd
$ roscd turtlebot_navigation/launch
$ roslaunch hokuyo.launch
[ INFO] 1256687975.743438000: Connected to device with ID: H0807344
```

- æ–°å¼€ç»ˆç«¯ï¼ŒæŸ¥çœ‹æ•°æ®

```cmd
$ rosrun rviz rviz
```

![image-20191112114058412](/assets/images/image-20191112114058412.png)

å·¦ä¸‹è§’æœ‰ä¸ªaddï¼Œç‚¹å‡»ï¼Œæ·»åŠ  laser/scanã€‚

æ­¤æ—¶ä¸€åˆ‡æ­£å¸¸çš„è¯åº”è¯¥å°±æœ‰å¦‚ä¸Šå›¾æ‰€ç¤ºçš„å›¾äº†ã€‚
